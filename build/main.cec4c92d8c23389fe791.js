(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"1heY":function(e,t,i){},AXzP:function(e,t,i){var n=i("mp5j");e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,a){return'<div class="page-container">\n    <h1 class="page-title">Популярные фильмы</h1>\n    <div class="js-home">\n        <ul class="page-main__films-list"></ul>\n    </div>\n    <div class="pagination">\n        <button class="btn-prev" disabled>\n            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n                <path\n                    d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm2 12l-4.5 4.5 1.527 1.5 5.973-6-5.973-6-1.527 1.5 4.5 4.5z" />\n            </svg>\n        </button>\n        <span class="current-page">1</span>\n        <button class="btn-next">\n            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n                <path\n                    d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm2 12l-4.5 4.5 1.527 1.5 5.973-6-5.973-6-1.527 1.5 4.5 4.5z" />\n            </svg>\n        </button>\n    </div>\n</div>'},useData:!0})},JNau:function(e,t,i){var n=i("mp5j");e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,a){var l,s=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,o="function",c=e.escapeExpression;return'<li class="film-card__container" title=\''+c(typeof(l=null!=(l=i.title||(null!=t?t.title:t))?l:r)===o?l.call(s,{name:"title",hash:{},data:a,loc:{start:{line:1,column:40},end:{line:1,column:49}}}):l)+'\'><img class="film-poster"\r\n        src="http://image.tmdb.org/t/p/w300'+c(typeof(l=null!=(l=i.poster_path||(null!=t?t.poster_path:t))?l:r)===o?l.call(s,{name:"poster_path",hash:{},data:a,loc:{start:{line:2,column:43},end:{line:2,column:60}}}):l)+'" alt="'+c(typeof(l=null!=(l=i.original_title||(null!=t?t.original_title:t))?l:r)===o?l.call(s,{name:"original_title",hash:{},data:a,loc:{start:{line:2,column:67},end:{line:2,column:87}}}):l)+'" data-id="'+c(typeof(l=null!=(l=i.id||(null!=t?t.id:t))?l:r)===o?l.call(s,{name:"id",hash:{},data:a,loc:{start:{line:2,column:98},end:{line:2,column:106}}}):l)+'">\r\n    <p class="film-card__name">'+c(typeof(l=null!=(l=i.title||(null!=t?t.title:t))?l:r)===o?l.call(s,{name:"title",hash:{},data:a,loc:{start:{line:3,column:31},end:{line:3,column:40}}}):l)+"</p>\r\n\r\n</li>"},useData:!0})},mng9:function(e,t,i){"use strict";i.r(t);i("Z/Hh"),i("1heY"),i("uQK7"),i("Muwe"),i("aZFp");var n=i("AXzP"),a=i.n(n),l=i("tSwl"),s=i.n(l);i("JBxO"),i("FdtR"),i("wcNg");function r(e,t,i,n,a,l,s){try{var r=e[l](s),o=r.value}catch(e){return void i(e)}r.done?t(o):Promise.resolve(o).then(n,a)}function o(e){return function(){var t=this,i=arguments;return new Promise((function(n,a){var l=e.apply(t,i);function s(e){r(l,n,a,s,o,"next",e)}function o(e){r(l,n,a,s,o,"throw",e)}s(void 0)}))}}var c,u,d,h="https://api.themoviedb.org/3/",m="4c70739ab1bc7f2c582885ab460406ce",g={allFilms:(d=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,fetch(h+"movie/popular?language=ru-RU&api_key="+m+"&page="+t).then((function(e){return e.json()}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)}),filmInfo:(u=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,fetch(h+"movie/"+t+"?api_key="+m+"&language=ru-RU").then((function(e){return e.json()}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)}),searchFilms:(c=o(regeneratorRuntime.mark((function e(t,i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,fetch(h+"search/movie?language=ru-RU&api_key="+m+"&query="+t+"&page="+i).then((function(e){return e.json()}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(e,t){return c.apply(this,arguments)})},p=i("JNau"),f=i.n(p),v=(i("Xlt+"),i("X5mX"),i("uH8g")),b=i.n(v),_=(i("RtS0"),i("8cZI"),i("lmye"),i("3dw1"),function(e,t){e.insertAdjacentHTML("beforeend",t)}),w=function(e){e.innerHTML=""},y=function(e,t){return e.map((function(e){return t(e)})).join("")},S=function(e){return setTimeout((function(){var t=document.querySelectorAll(".film-poster");console.dir(e),console.log(e.children),console.log(t),t.forEach((function(e,t){"http://image.tmdb.org/t/p/w300"===e.src&&(console.log("no picture idx "+t),e.src="./images/default.jpg")}))}),600)},q={init:function(){this.watchedFlag=!1,this.queuedFlag=!1,this.main=document.querySelector(".page-main"),this.filmList=document.querySelector(".page-main__films-list"),this.filmId=this.filmId?this.filmId:window.location.search.split("?")[1],this.bindEvents()},bindEvents:function(){this.filmList.addEventListener("click",this.generateFilmInfoPage.bind(this))},getFilmId:function(e){"IMG"===e.target.tagName?this.filmId=e.target.dataset.id:"P"===e.target.tagName?this.filmId=e.target.previousElementSibling.dataset.id:this.filmId=void 0},getMovieData:function(){var e=this;this.filmId&&(w(T.main),g.filmInfo(this.filmId).then((function(t){_(e.main,b()(t)),e.addToLibrary()})))},generateFilmInfoPage:function(){-1===window.location.href.indexOf("movie")&&this.getFilmId(event),void 0!==this.filmId&&(w(this.main),this.getMovieData(),history.pushState(null,null,"/movie?"+this.filmId))},addToLibrary:function(){localStorage.setItem("watchedFilms",[T.watched]),localStorage.setItem("queuedFilms",[T.queued]),this.addToWatchBtn=document.querySelector("#overlooked"),this.addToQueueBtn=document.querySelector("#add-to-queue"),this.getLocalStorageWatchedData(),this.getLocalStorageQueuedData(),this.addToWatchBtn.addEventListener("click",this.toggleWatchedStatus.bind(this)),this.addToQueueBtn.addEventListener("click",this.toggleQueuedStatus.bind(this)),this.watchedFlag?(this.addToWatchBtn.innerText="Добавить",this.watchedFlag=!1):(this.addToWatchBtn.innerText="Удалить",this.watchedFlag=!0),this.queuedFlag?(this.addToQueueBtn.innerText="Добавить",this.queuedFlag=!1):(this.addToQueueBtn.innerText="Удалить",this.queuedFlag=!0)},addToLocalStorage:function(e,t){0!==t.length?-1===t.indexOf(this.filmId)&&(t.push(this.filmId),localStorage.setItem(e,[t])):(t.push(this.filmId),localStorage.setItem(e,[t]))},removeFromLocalStorage:function(e,t){var i=t.indexOf(this.filmId);t.splice(i,1),localStorage.setItem(e,t)},getLocalStorageWatchedData:function(){null!==localStorage.getItem("watchedFilms")&&(localStorage.getItem("watchedFilms").split(",").indexOf(this.filmId)>-1?this.watchedFlag=!1:this.watchedFlag=!0)},getLocalStorageQueuedData:function(){null!==localStorage.getItem("queuedFilms")&&(localStorage.getItem("queuedFilms").split(",").indexOf(this.filmId)>-1?this.queuedFlag=!1:this.queuedFlag=!0)},toggleWatchedStatus:function(){this.watchedFlag?(this.addToWatchBtn.innerText="Добавить",this.watchedFlag=!1,this.removeFromLocalStorage("watchedFilms",T.watched)):(this.addToWatchBtn.innerText="Удалить",this.watchedFlag=!0,this.addToLocalStorage("watchedFilms",T.watched))},toggleQueuedStatus:function(){this.queuedFlag?(this.addToQueueBtn.innerText="Добавить",this.queuedFlag=!1,this.removeFromLocalStorage("queuedFilms",T.queued)):(this.addToQueueBtn.innerText="Удалить",this.queuedFlag=!0,this.addToLocalStorage("queuedFilms",T.queued))}},F={init:function(){this.query=this.query?this.query:window.location.search.split("?")[1],this.page=1,this.pageNumber=document.querySelector(".current-page"),this.nextBtn=document.querySelector(".btn-next"),this.prevBtn=document.querySelector(".btn-prev"),this.pageTitle=document.querySelector(".page-title"),this.filmList=document.querySelector(".page-main__films-list"),this.searchForm=document.querySelector(".search__form"),this.searchInput=document.querySelector(".search__input"),window.location.href.indexOf("search")>-1&&this.getSearchedFilms(this.query,this.page),this.bindEvents()},bindEvents:function(){this.searchForm.addEventListener("submit",this.submitSearch.bind(this)),this.searchInput.addEventListener("input",this.getSearchQuery.bind(this)),this.nextBtn.addEventListener("click",this.nextPage.bind(this)),this.prevBtn.addEventListener("click",this.prevPage.bind(this))},submitSearch:function(e){e.preventDefault(),this.getSearchPage()},getSearchPage:function(){void 0!==this.query&&(history.pushState(null,null,"/search?"+this.query),location.reload())},getSearchedFilms:function(e,t){var i=this;this.pageTitle.innerText="Результат поиска:",this.searchInput.value="",g.searchFilms(e,t).then((function(e){i.page=e.page,w(i.filmList),_(i.filmList,y(e.results,f.a)),1===i.page&&i.prevBtn.setAttribute("disabled",""),i.page===e.total_pages&&i.nextBtn.setAttribute("disabled",""),e.total_pages<=20?(i.prevBtn.setAttribute("disabled",""),i.nextBtn.setAttribute("disabled","")):i.nextBtn.removeAttribute("disabled")}))},getSearchQuery:function(e){return this.query=e.target.value},generateAnotherPage:function(){w(this.filmList),window.scrollTo(0,0),this.prevBtn.removeAttribute("disabled"),this.pageNumber.innerHTML=this.page,window.location.href.indexOf("search")>-1&&this.getSearchedFilms(this.query,this.page)},nextPage:function(){this.page++,this.generateAnotherPage()},prevPage:function(){this.page--,this.generateAnotherPage()}},L={init:function(){this.page=1,this.pageNumber=document.querySelector(".current-page"),this.nextBtn=document.querySelector(".btn-next"),this.prevBtn=document.querySelector(".btn-prev"),this.pageTitle=document.querySelector(".page-title"),this.filmList=document.querySelector(".page-main__films-list"),"/"===window.location.pathname&&this.getAllFilms(this.page),this.bindEvents(),q.init(),F.init()},bindEvents:function(){this.nextBtn.addEventListener("click",this.nextPage.bind(this)),this.prevBtn.addEventListener("click",this.prevPage.bind(this))},getAllFilms:function(e){var t=this;g.allFilms(e||1).then((function(e){return t.page=e.page,w(t.filmList),_(t.filmList,y(e.results,f.a)),1===t.page&&t.prevBtn.setAttribute("disabled",""),t.page===e.total_pages&&t.nextBtn.setAttribute("disabled",""),e}))},generateAnotherPage:function(){w(this.filmList),window.scrollTo(0,0),this.prevBtn.removeAttribute("disabled"),this.pageNumber.innerHTML=this.page,"/"===window.location.pathname&&this.getAllFilms(this.page)},nextPage:function(){this.page++,this.generateAnotherPage()},prevPage:function(){this.page--,this.generateAnotherPage()}},x={init:function(){this.filmList=document.querySelector(".page-main__films-list"),this.watchedFilms=document.querySelector(".page-main__films-list--watched"),this.queuedFilms=document.querySelector(".page-main__films-list--queued"),this.build("watchedFilms",this.watchedFilms),this.build("queuedFilms",this.queuedFilms),this.bindEvents(),q.init(),this.getTrigger()},bindEvents:function(){this.queuedFilms.addEventListener("click",q.generateFilmInfoPage.bind(q)),window.onload=S(this.filmList)},build:function(e,t){null!==localStorage.getItem(e)&&localStorage.getItem(e).split(",").forEach((function(e){""!==e&&g.filmInfo(e).then((function(e){_(t,f()(e))}))}))},getTrigger:function(){document.querySelectorAll(".js-tab-trigger").forEach((function(e){e.addEventListener("click",(function(){var t=this.getAttribute("data-tab"),i=document.querySelector('.js-tab-content[data-tab="'+t+'"]'),n=document.querySelector(".js-tab-trigger.active"),a=document.querySelector(".js-tab-content.active");n.classList.remove("active"),e.classList.add("active"),a.classList.remove("active"),i.classList.add("active")}))}))}},T={init:function(){this.watched=localStorage.getItem("watchedFilms")?localStorage.getItem("watchedFilms").split(","):[],this.queued=localStorage.getItem("queuedFilms")?localStorage.getItem("queuedFilms").split(","):[],this.main=document.querySelector(".page-main"),this.homePageLink=document.querySelector(".header-nav__link--main"),this.logoLink=document.querySelector(".header-nav__logo"),this.libraryPageLink=document.querySelector(".header-nav__link--library"),this.mainPage=document.querySelector(".js-home"),this.toTopBtn=document.querySelector(".page-footer__to-top"),this.loader=document.querySelector(".loader"),this.bindEvents(),this.showPages(),window.onload=this.deleteLoader()},bindEvents:function(){this.homePageLink.addEventListener("click",this.generateHomePage.bind(this)),this.logoLink.addEventListener("click",this.generateHomePage.bind(this)),this.libraryPageLink.addEventListener("click",this.generateLibraryPage.bind(this)),this.toTopBtn.addEventListener("click",this.scrollToTop.bind(this))},generateHome:function(){w(this.main),_(this.main,a()(this.main)),L.init()},generateHomePage:function(e){e.preventDefault(),history.pushState(null,null,"/"),this.generateHome()},generateLibraryPage:function(e){e.preventDefault(),this.generateLibrary()},generateLibrary:function(){w(this.main),_(this.main,s()(this.main)),history.pushState(null,null,"/library"),x.init()},showPages:function(){this.generateHome(),window.location.href.indexOf("library")>-1&&this.generateLibrary(),window.location.href.indexOf("movie")>-1&&q.generateFilmInfoPage()},deleteLoader:function(){setTimeout((function(){var e=document.querySelector(".loader"),t=document.querySelector("body"),i=document.querySelector("header"),n=document.querySelector("footer");i.style.visibility="visible",n.style.visibility="visible",t.style.overflow="visible",e.style.display="none"}),500)},scrollToTop:function(){window.scrollTo({top:0,behavior:"smooth"})}};T.init()},tSwl:function(e,t,i){var n=i("mp5j");e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,a){return'<div class="page-container">\n    <h1 class="page-title">Моя библиотека</h1>\n    <div class="tabs">\n        <ul class="tab-header">\n            <li class="tab-header__item js-tab-trigger active" data-tab="1">Просмотренные</li>\n            <li class="tab-header__item js-tab-trigger" data-tab="2">В очереди</li>\n        </ul>\n        <ul class="tab-content">\n            <li class="tab-content__item js-tab-content active" data-tab="1">\n                <ul class="page-main__films-list page-main__films-list--watched"></ul>\n            </li>\n            <li class="tab-content__item js-tab-content" data-tab="2">\n                <ul class="page-main__films-list page-main__films-list--queued"></ul>\n            </li>\n        </ul>\n    </div>\n</div>'},useData:!0})},uH8g:function(e,t,i){var n=i("mp5j");e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,a){var l,s=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,o="function",c=e.escapeExpression;return'<div class="page-container">\r\n    <h1 class="page-title">Информация о фильме</h1>\r\n    <div class="js-home">\r\n        <ul class="page-main__films-list">\r\n            <li class="film__card">\r\n                <h3 class="film__card--title">'+c(typeof(l=null!=(l=i.title||(null!=t?t.title:t))?l:r)===o?l.call(s,{name:"title",hash:{},data:a,loc:{start:{line:6,column:46},end:{line:6,column:55}}}):l)+'</h3>\r\n                <img class="film__card--poster"\r\n                    srcset=\'https://image.tmdb.org/t/p/w200'+c(typeof(l=null!=(l=i.poster_path||(null!=t?t.poster_path:t))?l:r)===o?l.call(s,{name:"poster_path",hash:{},data:a,loc:{start:{line:8,column:59},end:{line:8,column:74}}}):l)+" , ../src/images/default.jpg'\r\n                    alt="+c(typeof(l=null!=(l=i.original_title||(null!=t?t.original_title:t))?l:r)===o?l.call(s,{name:"original_title",hash:{},data:a,loc:{start:{line:9,column:24},end:{line:9,column:42}}}):l)+" />\r\n                <img class=\"film__card--poster\" srcset='../images/default.jpg' alt="+c(typeof(l=null!=(l=i.original_title||(null!=t?t.original_title:t))?l:r)===o?l.call(s,{name:"original_title",hash:{},data:a,loc:{start:{line:10,column:83},end:{line:10,column:101}}}):l)+' />\r\n                <div class="film__card-attr">\r\n                    <span class="film__card-stars"><i class="material-icons icon--star">stars</i>'+c(typeof(l=null!=(l=i.vote_average||(null!=t?t.vote_average:t))?l:r)===o?l.call(s,{name:"vote_average",hash:{},data:a,loc:{start:{line:12,column:97},end:{line:12,column:113}}}):l)+'</span>\r\n                    <span class="film__card-release">Дата выхода: '+c(typeof(l=null!=(l=i.release_date||(null!=t?t.release_date:t))?l:r)===o?l.call(s,{name:"release_date",hash:{},data:a,loc:{start:{line:13,column:66},end:{line:13,column:82}}}):l)+'</span>\r\n                </div>\r\n                <div class="film__card-buttons">\r\n                    <button id="overlooked" class="film__card-button">\r\n                        <i class="material-icons icon--star">folder_open</i> Добавить в\r\n                        просмотренные\r\n                    </button>\r\n                    <button id="add-to-queue" class="film__card-button">\r\n                        <i class="material-icons icon--star">add_circle_outline</i> Добавить\r\n                        в очередь просмотра\r\n                    </button>\r\n                </div>\r\n                <details>\r\n                    <summary>Показать описание</summary>\r\n                    '+c(typeof(l=null!=(l=i.overview||(null!=t?t.overview:t))?l:r)===o?l.call(s,{name:"overview",hash:{},data:a,loc:{start:{line:27,column:20},end:{line:27,column:32}}}):l)+"\r\n                </details>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</div>"},useData:!0})}},[["mng9",1,2]]]);
//# sourceMappingURL=main.cec4c92d8c23389fe791.js.map